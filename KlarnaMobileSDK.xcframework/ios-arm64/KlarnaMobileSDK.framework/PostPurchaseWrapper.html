<!doctype html><html><head><meta http-equiv="Content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,viewport-fit=cover"/><meta http-equiv="Content-Security-Policy" content="object-src 'none'; base-uri 'none'; frame-ancestors 'none';"/><title>Post Purchase</title><script>/*! For license information please see app.js.LICENSE.txt */
(()=>{var e={449:function(e,t,r){!function(e){"use strict";var t,r=function(){try{if(e.URLSearchParams&&"bar"===new e.URLSearchParams("foo=bar").get("foo"))return e.URLSearchParams}catch(e){}return null}(),n=r&&"a=1"===new r({a:1}).toString(),i=r&&"+"===new r("s=%2B").get("s"),a=r&&"size"in r.prototype,o="__URLSearchParams__",s=!r||((t=new r).append("s"," &"),"s=+%26"===t.toString()),l=p.prototype,u=!(!e.Symbol||!e.Symbol.iterator);if(!(r&&n&&i&&s&&a)){l.append=function(e,t){m(this[o],e,t)},l.delete=function(e){delete this[o][e]},l.get=function(e){var t=this[o];return this.has(e)?t[e][0]:null},l.getAll=function(e){var t=this[o];return this.has(e)?t[e].slice(0):[]},l.has=function(e){return _(this[o],e)},l.set=function(e,t){this[o][e]=[""+t]},l.toString=function(){var e,t,r,n,i=this[o],a=[];for(t in i)for(r=g(t),e=0,n=i[t];e<n.length;e++)a.push(r+"="+g(n[e]));return a.join("&")};var d,c=e.Proxy&&r&&(!i||!s||!n||!a);c?(d=new Proxy(r,{construct:function(e,t){return new e(new p(t[0]).toString())}})).toString=Function.prototype.toString.bind(p):d=p,Object.defineProperty(e,"URLSearchParams",{value:d});var h=e.URLSearchParams.prototype;h.polyfill=!0,!c&&e.Symbol&&(h[e.Symbol.toStringTag]="URLSearchParams"),"forEach"in h||(h.forEach=function(e,t){var r=v(this.toString());Object.getOwnPropertyNames(r).forEach((function(n){r[n].forEach((function(r){e.call(t,r,n,this)}),this)}),this)}),"sort"in h||(h.sort=function(){var e,t,r,n=v(this.toString()),i=[];for(e in n)i.push(e);for(i.sort(),t=0;t<i.length;t++)this.delete(i[t]);for(t=0;t<i.length;t++){var a=i[t],o=n[a];for(r=0;r<o.length;r++)this.append(a,o[r])}}),"keys"in h||(h.keys=function(){var e=[];return this.forEach((function(t,r){e.push(r)})),P(e)}),"values"in h||(h.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),P(e)}),"entries"in h||(h.entries=function(){var e=[];return this.forEach((function(t,r){e.push([r,t])})),P(e)}),u&&(h[e.Symbol.iterator]=h[e.Symbol.iterator]||h.entries),"size"in h||Object.defineProperty(h,"size",{get:function(){var e=v(this.toString());if(h===this)throw new TypeError("Illegal invocation at URLSearchParams.invokeGetter");return Object.keys(e).reduce((function(t,r){return t+e[r].length}),0)}})}function p(e){((e=e||"")instanceof URLSearchParams||e instanceof p)&&(e=e.toString()),this[o]=v(e)}function g(e){var t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'\(\)~]|%20|%00/g,(function(e){return t[e]}))}function f(e){return e.replace(/[ +]/g,"%20").replace(/(%[a-f0-9]{2})+/gi,(function(e){return decodeURIComponent(e)}))}function P(t){var r={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return u&&(r[e.Symbol.iterator]=function(){return r}),r}function v(e){var t={};if("object"==typeof e)if(y(e))for(var r=0;r<e.length;r++){var n=e[r];if(!y(n)||2!==n.length)throw new TypeError("Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements");m(t,n[0],n[1])}else for(var i in e)e.hasOwnProperty(i)&&m(t,i,e[i]);else{0===e.indexOf("?")&&(e=e.slice(1));for(var a=e.split("&"),o=0;o<a.length;o++){var s=a[o],l=s.indexOf("=");-1<l?m(t,f(s.slice(0,l)),f(s.slice(l+1))):s&&m(t,f(s),"")}}return t}function m(e,t,r){var n="string"==typeof r?r:null!=r&&"function"==typeof r.toString?r.toString():JSON.stringify(r);_(e,t)?e[t].push(n):e[t]=[n]}function y(e){return!!e&&"[object Array]"===Object.prototype.toString.call(e)}function _(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(void 0!==r.g?r.g:"undefined"!=typeof window?window:this)}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";r(449);var e,t=function(){function e(){this._searchParams=new URLSearchParams(location.search)}return e.prototype.getBoolean=function(e,t){var r=this._searchParams.get(e);return null!=r?"true"===r:t},e.prototype.getString=function(e){return this._searchParams.get(e)},e.prototype.getNumber=function(e,t){var r=this._searchParams.get(e)||"",n=parseInt(r);return isNaN(n)?t:n},e}();!function(e){e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warn=2]="Warn",e[e.Error=3]="Error",e[e.None=4]="None"}(e||(e={}));var n,i=function(){function t(){this._logLevel=e.None,this._logDelegate=null}return Object.defineProperty(t.prototype,"level",{get:function(){return this._logLevel},set:function(e){this._logLevel=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"delegate",{get:function(){return this._logDelegate},set:function(e){this._logDelegate=e},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._logLevel===e.Debug&&(null!=this._logDelegate&&this._logDelegate.logDebug(this._stringifyParams(t)),console.log.apply(console,t))},t.prototype.info=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._logLevel<=e.Info&&(null!=this._logDelegate&&this._logDelegate.logDebug(this._stringifyParams(t)),console.info.apply(console,t))},t.prototype.warn=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._logLevel<=e.Warn&&(null!=this._logDelegate&&this._logDelegate.logDebug(this._stringifyParams(t)),console.warn.apply(console,t))},t.prototype.error=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];this._logLevel<=e.Error&&(null!=this._logDelegate&&this._logDelegate.logError(this._stringifyParams(t)),console.error.apply(console,t))},t.prototype._stringifyParams=function(e){try{return JSON.stringify(e,null,2)}catch(e){return"Couldn't stringify logging params."}},t.default=new t,t}(),a=function(){function e(){}return e.randomString=function(e){void 0===e&&(e=10);for(var t="",r=0;r<e;r++)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(Math.floor(62*Math.random()));return t},e.capitalizeString=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e.commaSplitString=function(e){return e.split(/,\s*/)},e.createUUIDv4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))},e.find=function(e,t,r){if(void 0!==Array.prototype.find)return e.find(t,r);if(!(null!==e&&e instanceof Array))throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var n=Object(e),i=n.length>>>0,a=0;a<i;a++){var o=n[a];if(t.call(r,o,a,n))return o}},e}(),o=function(){function e(e,t){this.isPublic=!1,this.isFatal=!1,this.message=e,this.actionType=t}return e.prototype.toParams=function(){var e={};return e.message=this.message,e.isPublic=1==this.isPublic?"true":"false",e.isFatal=1==this.isFatal?"true":"false",null!=this.actionType&&(e.actionType=this.actionType),null!=this.status&&(e.status=this.status),e},e}(),s=function(e,t,r){void 0===r&&(r={}),this.action=e,this.sender=t,this.receiver="Native",this.params=r,this.messageId=a.randomString()};!function(e){e.Debug="debug",e.Info="info",e.Error="error",e.All="all",e.Off="off"}(n||(n={}));var l,u=function(){function e(e,t){this.name=e,this.level=t}return e.PageLoad=new e("PostPurchaseWrapperPageLoad",n.Info),e.SdkFound=new e("PostPurchaseWrapperSdkFound",n.Debug),e.SdkNotFound=new e("PostPurchaseWrapperSdkNotFound",n.Debug),e.AddingMessageBridge=new e("PostPurchaseWrapperAddingMessageBridge",n.Debug),e.MessageBridgeAdded=new e("PostPurchaseWrapperMessageBridgeAdded",n.Debug),e.MessageBridgeLoadError=new e("PostPurchaseWrapperMessageBridgeLoadError",n.Error),e.InitializeNotCalled=new e("PostPurchaseWrapperInitializeNotCalled",n.Error),e.AddingLibrary=new e("PostPurchaseWrapperAddingLibrary",n.Debug),e.LibraryAlreadyAdded=new e("PostPurchaseWrapperLibraryAlreadyAdded",n.Debug),e.LibraryAdded=new e("PostPurchaseWrapperLibraryAdded",n.Debug),e.LibraryLoadError=new e("PostPurchaseWrapperLibraryLoadError",n.Error),e.ReceivedInitialize=new e("PostPurchaseWrapperReceivedInitialize",n.Info),e.ValidatedInitialize=new e("PostPurchaseWrapperValidatedInitialize",n.Debug),e.PerformingInitialize=new e("PostPurchaseWrapperPerformingInitialize",n.Debug),e.PerformedInitialize=new e("PostPurchaseWrapperPerformedInitialize",n.Debug),e.SentInitializeResponse=new e("PostPurchaseWrapperSentInitializeResponse",n.Info),e.InitializeException=new e("PostPurchaseWrapperInitializeException",n.Error),e.ReceivedAuthorize=new e("PostPurchaseWrapperReceivedAuthorize",n.Info),e.ValidatedAuthorize=new e("PostPurchaseWrapperValidatedAuthorize",n.Debug),e.PerformingAuthorize=new e("PostPurchaseWrapperPerformingAuthorize",n.Debug),e.PerformedAuthorize=new e("PostPurchaseWrapperPerformedAuthorize",n.Debug),e.SentAuthorizeResponse=new e("PostPurchaseWrapperSentAuthorizeResponse",n.Info),e.AuthorizeException=new e("PostPurchaseWrapperAuthorizeException",n.Error),e.ReceivedRender=new e("PostPurchaseWrapperReceivedRender",n.Info),e.ValidatedRender=new e("PostPurchaseWrapperValidatedRender",n.Debug),e.PerformingRender=new e("PostPurchaseWrapperPerformingRender",n.Debug),e.PerformedRender=new e("PostPurchaseWrapperPerformedRender",n.Debug),e.SentRenderResponse=new e("PostPurchaseWrapperSentRenderResponse",n.Info),e.RenderException=new e("PostPurchaseWrapperRenderException",n.Error),e}();!function(e){e[e.AsString=0]="AsString"}(l||(l={}));var d=function(){function e(e,t){this._errors=[],this._messages=[],this._queuedMessages=[],this._componentName="KlarnaPostPurchaseWrapper",this._storeErrorsAndMessages=e,this._analyticsController=t}return Object.defineProperty(e.prototype,"componentName",{get:function(){return this._componentName},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t){var r=this;i.default.debug("Initializing MessageController."),e.addAsReceiver(this.componentName),e.addMessageCallback((function(e,n){r._receivedMessage(e,n,t)})),e.sendHandshake((function(n){null!=r._analyticsController&&null!=n&&r._analyticsController.setHandshakeMessage(n),t.addPostPurchaseLibrary(r,e,(function(n){n&&(r._queuedMessages.forEach((function(n){r._receivedMessage(n,e,t)})),r._queuedMessages=[])}))}))},e.prototype._receivedMessage=function(e,t,r){this._storeErrorsAndMessages&&this._messages.push(e);var n=e.receiver===this.componentName,s=a.find(["PostPurchaseInitialize","PostPurchaseAuthorizationRequest","PostPurchaseRenderOperation"],(function(t){return t===e.action}));if(n&&null!=s){if(!r.libraryAdded){i.default.error("Received a message to forward to Post Purchase Library, but it's not loaded.");var l=new o("Got message to Post Purchase Library, but it hasn't been added yet.",s);return this.sendError(l,t),void this._queuedMessages.push(e)}if("PostPurchaseInitialize"===s)(d={}).locale=e.params.locale,d.purchaseCountry=e.params.purchaseCountry,d.design=e.params.design,this._logAnalyticsEvent(u.ReceivedInitialize,d),this._handleInitialize(e,t,r);else if("PostPurchaseAuthorizationRequest"===s)(d={}).clientId=e.params.clientId,d.purchaseCountry=e.params.purchaseCountry,d.design=e.params.design,this._logAnalyticsEvent(u.ReceivedAuthorize,d),this._handleAuthorizationRequest(e,t,r);else if("PostPurchaseRenderOperation"===s){var d;(d={}).locale=e.params.locale,d.operationToken=e.params.operationToken,d.redirectUri=e.params.redirectUri,this._logAnalyticsEvent(u.ReceivedRender,d),this._handleRenderOperation(e,t,r)}}},e.prototype._handleInitialize=function(e,t,r){if(i.default.debug("Handling Post Purchase initialize."),this._validateRequiredParam(e,t,"locale",l.AsString,!1,"PostPurchaseInitialize")&&this._validateRequiredParam(e,t,"purchaseCountry",l.AsString,!1,"PostPurchaseInitialize")&&this._validateRequiredParam(e,t,"design",l.AsString,!0,"PostPurchaseInitialize")){var n={locale:e.params.locale,purchase_country:e.params.purchaseCountry,design:e.params.design};r.performInitialize(n,this,t),this._logAnalyticsEvent(u.ValidatedInitialize)}},e.prototype._handleAuthorizationRequest=function(e,t,r){if(i.default.debug("Handling Post Purchase authorization request."),this._validateRequiredParam(e,t,"clientId",l.AsString,!1,"PostPurchaseAuthorizationRequest")&&this._validateRequiredParam(e,t,"locale",l.AsString,!0,"PostPurchaseAuthorizationRequest")&&this._validateRequiredParam(e,t,"scope",l.AsString,!1,"PostPurchaseAuthorizationRequest")&&this._validateRequiredParam(e,t,"redirectUri",l.AsString,!1,"PostPurchaseAuthorizationRequest")&&this._validateRequiredParam(e,t,"state",l.AsString,!0,"PostPurchaseAuthorizationRequest")&&this._validateRequiredParam(e,t,"loginHint",l.AsString,!0,"PostPurchaseAuthorizationRequest")&&this._validateRequiredParam(e,t,"responseType",l.AsString,!0,"PostPurchaseAuthorizationRequest")){this._logAnalyticsEvent(u.ValidatedAuthorize);var n={client_id:e.params.clientId,locale:e.params.locale,scope:e.params.scope,redirect_uri:e.params.redirectUri,state:e.params.state,login_hint:e.params.loginHint,response_type:e.params.responseType};r.performAuthorizationRequest(n,this,t)}},e.prototype._handleRenderOperation=function(e,t,r){if(i.default.debug("Handling Post Purchase render operation."),this._validateRequiredParam(e,t,"locale",l.AsString,!0,"PostPurchaseRenderOperation")&&this._validateRequiredParam(e,t,"operationToken",l.AsString,!1,"PostPurchaseRenderOperation")&&this._validateRequiredParam(e,t,"redirectUri",l.AsString,!0,"PostPurchaseRenderOperation")){this._logAnalyticsEvent(u.ValidatedRender);var n={locale:e.params.locale,operation_token:e.params.operationToken,redirect_uri:e.params.redirectUri};r.performRenderOperation(n,this,t)}},e.prototype._validateRequiredParam=function(e,t,r,n,i,a){if(void 0===e.params[r]){if(i)return!0;var s=new o("Param "+r+" is undefined.",a);return s.isPublic=!0,s.isFatal=!1,this.sendError(s,t),!1}if(null===e.params[r]){if(i)return!0;var u=new o("Param "+r+" is null.",a);return u.isPublic=!0,u.isFatal=!1,this.sendError(u,t),!1}if(n===l.AsString){var d=e.params[r];if(0==(null==d?void 0:d.length)){var c=new o("Param can't be an empty or blank string for "+r+".",a);return c.isPublic=!0,c.isFatal=!1,this.sendError(c,t),!1}}return!0},e.prototype.sendError=function(e,t){this._storeErrorsAndMessages&&this._errors.push(e),t.sendMessage(new s("PostPurchaseError",this.componentName,e.toParams()),null)},e.prototype._logAnalyticsEvent=function(e,t){null!=this._analyticsController&&this._analyticsController.reportEvent(e,t)},e}(),c=function(){function e(e,t){this.reqAction=e,this.resAction=t}return e.ResponseForAction=function(t){var r=a.find(e.PredefinedActions,(function(e){return e.reqAction===t}));return null!=r?r.resAction:null},e.HasResponse=function(e){return null!=this.ResponseForAction(e)},e.PredefinedActions=[new e("handshake","handshakeResponse")],e}(),h=function(){function e(){var e=this;this._receiverName=null,this._receivedMessages=[],this._sentMessages=[],this._allMessages=[],this._callbacks=[],this._storeAllMessages=!1,this._messageHandler=function(t){i.default.debug("Received message: \n"+JSON.stringify(t,null,2)),e._receivedMessages.push(t),e._storeAllMessages&&e._allMessages.push(t),e._notifyCallbacks(t)}}return Object.defineProperty(e.prototype,"storeAllMessages",{get:function(){return this._storeAllMessages},set:function(e){this._storeAllMessages=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"receiverName",{get:function(){return this._receiverName},enumerable:!1,configurable:!0}),e.prototype.addAsReceiver=function(e){null!=this._receiverName&&i.default.warn("Attempting to re-add as receiver ".concat(e,".")),i.default.debug("Adding as receiver: ".concat(e,".")),window.__KlarnaNativeHook.addReceiver(e,this._messageHandler),this._receiverName=e},e.prototype.removeAsReceiver=function(){window.__KlarnaNativeHook.removeReceiver(this._receiverName,this._messageHandler),this._receiverName=null},e.prototype.sendMessage=function(e,t){var r=this;this._storeAllMessages&&(this._sentMessages.push(e),this._allMessages.push(e)),i.default.debug("Sending message: \n"+JSON.stringify(e,null,2)),window.__KlarnaNativeHook.postMessage(e);var n=c.ResponseForAction(e.action);if(null!=t)if(null!=n)var o=window.setInterval((function(){var i=a.find(r._receivedMessages,(function(t){return t.action===n&&t.messageId===e.messageId}));null!=i&&(t(i),window.clearInterval(o))}),100);else t(null)},e.prototype.sendHandshake=function(e){if(null!=this._receiverName){var t=new s("handshake",this._receiverName);this.sendMessage(t,e)}},e.prototype._notifyCallbacks=function(e){var t=this;this._callbacks.forEach((function(r){r(e,t)}))},e.prototype.addMessageCallback=function(e){this._callbacks.push(e)},e.prototype.removeMessageCallback=function(e){this._callbacks=this._callbacks.filter((function(t){return t!==e}))},e}(),p=function(){function e(e,t,r){this._libraryAdded=!1,this._initialized=!1,this._environment=e,this._region=t,this._analyticsController=r}return Object.defineProperty(e.prototype,"libraryAdded",{get:function(){return this._libraryAdded},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"initialized",{get:function(){return this._initialized},enumerable:!1,configurable:!0}),e.prototype.addPostPurchaseLibrary=function(e,t,r){var n=this;i.default.debug("Adding Klarna Post Purchase Library into page head."),this._logAnalyticsEvent(u.AddingLibrary,{environment:this._environment,region:this._region});var a="PostPurchaseLibraryScript";null!=document.getElementById(a)&&(i.default.warn("Post Purchase Library already added to page. Won't add it again."),this._logAnalyticsEvent(u.LibraryAlreadyAdded),r(!1)),i.default.debug("Creating script element for Post Purchase Library as #".concat(a,"."));var s=document.createElement("script");s.src=this.getPostPurchaseLibraryUrl(this._environment,this._region),s.async=!0,s.addEventListener("load",(function(){n._libraryAdded=!0,i.default.debug("Post Purchase Library added."),n._logAnalyticsEvent(u.LibraryAdded),r(!0)})),s.addEventListener("error",(function(a){i.default.error("Error adding Post Purchase Lib.",a),n._logAnalyticsEvent(u.LibraryLoadError,{error:JSON.stringify(a)});var s=new o("Error adding Post Purchase library: "+a.message,"PostPurchaseCreate");s.isPublic=!1,s.isFatal=!0,e.sendError(s,t),r(!1)})),s.id=a,document.head.appendChild(s)},e.prototype.performInitialize=function(e,t,r){i.default.debug("Performing Klarna.PostPurchaseExperience.init()."),this._logAnalyticsEvent(u.PerformingInitialize);try{window.Klarna.PostPurchaseExperience.init(e),this._initialized=!0,this._logAnalyticsEvent(u.PerformedInitialize);var n=new s("PostPurchaseInitializeResponse",t.componentName);r.sendMessage(n,null),this._logAnalyticsEvent(u.SentInitializeResponse)}catch(e){i.default.error("Error performing Klarna.PostPurchaseExperience.init().",e),this._logAnalyticsEvent(u.InitializeException,{error:JSON.stringify(e)});var a=new o(e.message,"PostPurchaseInitialize");a.isPublic=!0,a.isFatal=!1,t.sendError(a,r)}},e.prototype.performAuthorizationRequest=function(e,t,r){if(i.default.debug("Performing Klarna.PostPurchaseExperience.authorizationRequest()."),this._logAnalyticsEvent(u.PerformingAuthorize),this.initialized)try{window.Klarna.PostPurchaseExperience.authorizationRequest(e),this._logAnalyticsEvent(u.PerformedAuthorize);var n=new s("PostPurchaseAuthorizationRequestResponse",t.componentName);r.sendMessage(n,null),this._logAnalyticsEvent(u.SentAuthorizeResponse)}catch(e){i.default.error("Error performing Klarna.PostPurchaseExperience.authorizationRequest().",e),this._logAnalyticsEvent(u.AuthorizeException,{error:JSON.stringify(e)});var a=new o(e.message,"PostPurchaseAuthorizationRequest");a.isPublic=!0,a.isFatal=!1,t.sendError(a,r)}else this.sendNotInitializedError(t,r,"PostPurchaseAuthorizationRequest")},e.prototype.performRenderOperation=function(e,t,r){var n=this;if(i.default.debug("Performing Klarna.PostPurchaseExperience.renderOperation()."),this._logAnalyticsEvent(u.PerformingRender),this.initialized)try{window.Klarna.PostPurchaseExperience.renderOperation(e,(function(e,a){if(e){i.default.error("Error performing Klarna.PostPurchaseExperience.renderOperation().",JSON.stringify(e)),n._logAnalyticsEvent(u.RenderException,{error:JSON.stringify(e)});var l=new o(e.message,"PostPurchaseRenderOperation");l.status=e.status,l.isPublic=!0,l.isFatal=!1,t.sendError(l,r)}else if(a){var d=new s("PostPurchaseRenderOperationResponse",t.componentName);d.params.renderOperationResult=a.status,r.sendMessage(d,null),n._logAnalyticsEvent(u.SentRenderResponse)}})),this._logAnalyticsEvent(u.PerformedRender)}catch(e){i.default.error("Error performing Klarna.PostPurchaseExperience.renderOperation().",e),this._logAnalyticsEvent(u.RenderException,{error:JSON.stringify(e)});var a=new o(e.message,"PostPurchaseRenderOperation");a.isPublic=!0,a.isFatal=!1,t.sendError(a,r)}else this.sendNotInitializedError(t,r,"PostPurchaseRenderOperation")},e.prototype.sendNotInitializedError=function(e,t,r){var n=new o("Post-Purchase SDK is not initialized. Please make sure to call initialize() first.",r);n.isPublic=!0,n.isFatal=!1,e.sendError(n,t),i.default.error("Post-Purchase SDK is not initialized. Please make sure to call initialize() first."),this._logAnalyticsEvent(u.InitializeNotCalled,{action:r})},e.prototype.getPostPurchaseLibraryUrl=function(e,t){var r="";e&&(r="playground"===e.toLowerCase()?"".concat("playground","/"):"");var n="";if(t)switch(t.toLowerCase()){case"na":case"oc":n="-".concat(t.toLowerCase());break;default:n=""}return"staging"===e?"".concat("https://s3.int.klarna.net/smi/sdk/index").concat(n,".js"):"".concat("https://x.klarnacdn.net/postpurchaseexperience/lib/v1/").concat(r,"sdk").concat(n,".js")},e.prototype._logAnalyticsEvent=function(e,t){null!=this._analyticsController&&this._analyticsController.reportEvent(e,t)},e}(),g=function(){function e(e,t){this._isLoaded=!1,this._analyticsController=e,this._endpoint=t}return Object.defineProperty(e.prototype,"isLoaded",{get:function(){return this._isLoaded},set:function(e){this._isLoaded=e},enumerable:!1,configurable:!0}),e.prototype.loadMessageBridge=function(e){var t=this;i.default.debug("Adding message bridge into page head."),this._logAnalyticsEvent(u.AddingMessageBridge),this.lookForMessageBridge(e);var r="MessageBridgeScript";i.default.debug("Creating script element for Message Bridge as #".concat(r,"."));var n=document.createElement("script");n.src="https://".concat(this._endpoint.assetsHost,"/mobile-sdk/mobile-js-snippet/v1/app.min.js"),n.async=!1,n.addEventListener("load",(function(){i.default.debug("Message bridge added."),t._logAnalyticsEvent(u.MessageBridgeAdded),t.isLoaded||(t.isLoaded=!0,e(!0))})),n.addEventListener("error",(function(e){i.default.error("Error adding Message bridge.",e),t._logAnalyticsEvent(u.MessageBridgeLoadError,{error:JSON.stringify(e)})})),n.id=r,document.head.appendChild(n)},e.prototype.lookForMessageBridge=function(e){if(null!=window.__KlarnaNativeHook)this.isLoaded||(this.isLoaded=!0,e(!0));else{var t=this;window.setTimeout((function(){t.lookForMessageBridge(e)}),500)}},e.prototype._logAnalyticsEvent=function(e,t){null!=this._analyticsController&&this._analyticsController.reportEvent(e,t)},e}(),f=function(){function e(){}return e.getEndpoint=function(t){return t&&a.find(e.endpoints,(function(e){return e.name===t.toLowerCase()}))||e.getDefaultEndpoint()},e.getDefaultEndpoint=function(){return e.endpoints[0]},e.endpointNameAws="aws",e.endpointNameAzure="azure",e.endpoints=[{name:e.endpointNameAws,assetsHost:"x.klarnacdn.net"},{name:e.endpointNameAzure,assetsHost:"z.klarnacdn.net"}],e}(),P=function(){function e(){this.additionalParams=null,this.event="undefined",this.sid="undefined",this.timestamp=Date.now()/1e3,this.wrapper={version:"undefined",environment:"undefined",region:"undefined"},this.device={os:"undefined",osVersion:"undefined",model:"undefined"},this.sdk={name:"undefined",version:"undefined",buildNumber:"undefined"},this.merchant={name:"undefined",packageName:"undefined",version:"undefined",buildNumber:"undefined"},this.additionalParams=null}return e.prototype.updateNativeParamsFromMessage=function(e){this.sdk.name=e.params.nativeName||"undefined",this.sdk.version=e.params.nativeVersion||"undefined",this.sdk.buildNumber=e.params.nativeBuildNumber||"undefined",this.device.model=e.params.deviceName||"undefined",this.device.os=e.params.osName||"undefined",this.device.osVersion=e.params.osVersion||"undefined",this.merchant.name=e.params.merchantAppName||"undefined",this.merchant.packageName=e.params.merchantAppID||"undefined",this.merchant.version=e.params.merchantAppVersion||"undefined",this.merchant.buildNumber=e.params.merchantAppBuildNumber||"undefined"},e.prototype.updateWithEvent=function(e,t){this.event=e.name,this.timestamp=Date.now()/1e3,this.additionalParams=t||null},e}(),v=function(){function e(e,t,r,n){this._analyticsData=new P,this._analyticsData.wrapper.environment=e,this._analyticsData.wrapper.region=t,this._analyticsData.wrapper.version="v1.0.2-855c759b32a",this._level=n,this._sid=a.createUUIDv4(),this._url=this.getAnalyticsUrl(e,t,r)}return e.prototype.setLevel=function(e){this._level=e},e.prototype.setHandshakeMessage=function(e){this._analyticsData.updateNativeParamsFromMessage(e)},e.prototype.reportEvent=function(e,t){this._analyticsData.updateWithEvent(e,t),this._analyticsData.sid=this._sid;var r=JSON.stringify(this._analyticsData);this._sendEvent(e,r)},e.prototype._sendEvent=function(e,t){if(this._shouldSendEvent(e)){i.default.debug("Sending event: "+e.name);var r="/v1/in-app/pp-wrapper/"+e.name,n=this._url+r;setTimeout((function(){window.fetch&&fetch(n,{method:"POST",body:t,mode:"no-cors"})}),0)}},e.prototype.getAnalyticsUrl=function(e,t,r){switch(r.name){case f.endpointNameAws:default:switch(e){case"production":default:return"https://eu.klarnaevt.com";case"playground":case"staging":return"https://frontend-event-router-eu.staging.c2c.klarna.net"}case f.endpointNameAzure:switch(e){case"production":default:return"https://naz.klarnaevt.com";case"playground":case"staging":return"naz.playground.klarnaevt.com"}}},e.prototype._shouldSendEvent=function(e){switch(this._level){case n.Off:return!1;case n.Error:return e.level===n.Error;case n.Info:return e.level===n.Info||e.level===n.Error;case n.Debug:return e.level===n.Debug||e.level===n.Info||e.level===n.Error;case n.All:return!0;default:return!1}},e}();window.addEventListener("load",(function(){var r,a,o,s,l,c,P=new t;i.default.level=P.getNumber("loglevel",e.None),i.default.debug("Page loaded. Initializing Post Purchase wrapper.");var m=f.getEndpoint(P.getString("endpoint")),y=null!==(a=null===(r=P.getString("environment"))||void 0===r?void 0:r.toLowerCase())&&void 0!==a?a:"production",_=null!==(s=null===(o=P.getString("region"))||void 0===o?void 0:o.toLowerCase())&&void 0!==s?s:"eu",b=null!==(c=null===(l=P.getString("analyticslevel"))||void 0===l?void 0:l.toLowerCase())&&void 0!==c?c:n.Info,A=new v(y,_,m,b);A.reportEvent(u.PageLoad),new g(A,m).loadMessageBridge((function(e){if(e){var t=P.getBoolean("storeall",!1);!function(e,t,r,n){if(null!=window.__KlarnaNativeHook&&window.__KlarnaNativeHook.inSdkWebView()){i.default.debug("Running in SDK."),e.reportEvent(u.SdkFound);var a=new d(n,e),o=new h,s=new p(t,r,e);window.__WrapperMessageController=a,n&&(window.__NativeHookController=o),o.storeAllMessages=n,a.initialize(o,s)}else i.default.debug("Not running in SDK."),e.reportEvent(u.SdkNotFound)}(A,y,_,t)}}))}))})()})();</script></head><body></body></html>